{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { defineStore } from 'pinia';\nimport sdk, { EventType } from 'matrix-js-sdk';\nlet roomNamesAndIdsAsObject = {};\nconst accessToken = \"syt_b2JzZXJ2ZXJ6ZXJv_qbsSNMdGRZpXMsNvXJeX_3OODDh\";\nconst userId = \"@oserverz:matrix.org\";\nconst baseUrl = 'https://matrix.org';\nconst client = sdk.createClient({\n  baseUrl: baseUrl,\n  accessToken: accessToken,\n  userId: userId\n});\nclient.startClient();\nasync function getRoomTopic(roomId) {\n  let room = client.getRoom(roomId);\n  let topic = await room.currentState.getStateEvents(EventType.RoomTopic);\n  return topic;\n}\nfetch(`${baseUrl}/_matrix/client/r0/rooms/${encodeURIComponent(roomId)}/state/m.room.topic`, {\n  headers: {\n    'Authorization': `Bearer ${accessToken}`\n  }\n}).then(response => {\n  if (!response.ok) {\n    throw new Error(`HTTP error ${response.status}`);\n  }\n  return response.json();\n}).then(json => {\n  const topic = json.topic;\n  console.log(`Room topic: ${topic}`);\n}).catch(error => {\n  console.error(`Error getting room: ${error}`);\n});\nfunction login() {\n  client.loginWithPassword('username', 'password').then(function () {\n    console.log('Logged in!');\n  });\n}\nfunction returnRoomNamesFromRoomObject(rooms) {\n  const roomNames = rooms.map(room => room.name);\n  return roomNames;\n}\nfunction returnRoomIdsFromRoomObject(rooms) {\n  const roomIds = rooms.map(room => room.roomId);\n  return roomIds;\n}\nfunction returnRoomMembersFromRoomObject(rooms) {\n  const roomMembers = rooms.map(room => room.type);\n  return roomMembers;\n}\nfunction getGroups() {\n  let rooms = client.getRooms();\n  let roomNames = returnRoomNamesFromRoomObject(rooms);\n  let roomIds = returnRoomIdsFromRoomObject(rooms);\n  let roomMembers = returnRoomMembersFromRoomObject(rooms);\n  let roomProduct = [];\n  for (let i = 0; i < roomNames.length; i++) {\n    roomProduct.push({\n      name: roomNames[i],\n      id: roomIds[i],\n      members: roomMembers[i]\n    });\n  }\n  Object.assign(roomNamesAndIdsAsObject, roomProduct);\n  console.log(roomNamesAndIdsAsObject);\n  return roomNamesAndIdsAsObject;\n}\nfunction createGroup(groupName) {\n  client.createRoom({\n    name: groupName,\n    visibility: 'private'\n  }).then(response => {\n    console.log(`Room created: ${response.room_id}`);\n  }).catch(error => {\n    console.error(`Error creating room: ${error}`);\n  });\n}\n\n//TODO - Add a getter to get a room's timeline\n//TODO - Add a getter to get a room's type\n\nexport const useMatrixClient = defineStore('matrix-client', {\n  state: () => {\n    return {\n      client: client,\n      getGroups: getGroups,\n      createGroup: createGroup\n    };\n  },\n  getters: {\n    getRooms: state => () => {\n      return state.getRooms();\n    },\n    getRoomNamesAndIds: state => () => {\n      return state.getGroups();\n    }\n  },\n  setters: {\n    createGroup: state => groupName => {\n      return state.createGroup(groupName);\n    }\n  }\n});","map":{"version":3,"names":["defineStore","sdk","EventType","roomNamesAndIdsAsObject","accessToken","userId","baseUrl","client","createClient","startClient","getRoomTopic","roomId","room","getRoom","topic","currentState","getStateEvents","RoomTopic","fetch","encodeURIComponent","headers","then","response","ok","Error","status","json","console","log","catch","error","login","loginWithPassword","returnRoomNamesFromRoomObject","rooms","roomNames","map","name","returnRoomIdsFromRoomObject","roomIds","returnRoomMembersFromRoomObject","roomMembers","type","getGroups","getRooms","roomProduct","i","length","push","id","members","Object","assign","createGroup","groupName","createRoom","visibility","room_id","useMatrixClient","state","getters","getRoomNamesAndIds","setters"],"sources":["/Users/observerzero/Project/Dev/icoo/src/stores/MatrixClient.js"],"sourcesContent":["import { defineStore } from 'pinia';\nimport sdk, {EventType} from 'matrix-js-sdk';\n\nlet roomNamesAndIdsAsObject = {};\nconst accessToken = \"syt_b2JzZXJ2ZXJ6ZXJv_qbsSNMdGRZpXMsNvXJeX_3OODDh\"\nconst userId = \"@oserverz:matrix.org\";\nconst baseUrl = 'https://matrix.org'\n\nconst client = sdk.createClient({\n  baseUrl: baseUrl,\n  accessToken: accessToken,\n  userId: userId,\n});\n\nclient.startClient();\n\nasync function getRoomTopic(roomId) {\n  let room = client.getRoom(roomId);\n  let topic = await room.currentState.getStateEvents(EventType.RoomTopic);\n  return topic;\n}\n\nfetch(`${baseUrl}/_matrix/client/r0/rooms/${encodeURIComponent(roomId)}/state/m.room.topic`, {\n  headers: {\n    'Authorization': `Bearer ${accessToken}`\n  }\n}).then((response) => {\n  if (!response.ok) {\n    throw new Error(`HTTP error ${response.status}`);\n  }\n  return response.json();\n}).then((json) => {\n  const topic = json.topic;\n  console.log(`Room topic: ${topic}`);\n}).catch((error) => {\n  console.error(`Error getting room: ${error}`);\n});\nfunction login() {\n  client.loginWithPassword('username', 'password').then(function() {\n    console.log('Logged in!')\n  })\n}\n\nfunction returnRoomNamesFromRoomObject(rooms) {\n  const roomNames = rooms.map(room => room.name);\n  return roomNames;\n}\n\nfunction returnRoomIdsFromRoomObject(rooms) {\n  const roomIds = rooms.map(room => room.roomId);\n  return roomIds;\n}\n\nfunction returnRoomMembersFromRoomObject(rooms) {\n  const roomMembers = rooms.map(room => room.type);\n  return roomMembers;\n}\n\nfunction getGroups() {\n  let rooms = client.getRooms()\n  let roomNames = returnRoomNamesFromRoomObject(rooms)\n  let roomIds = returnRoomIdsFromRoomObject(rooms);\n  let roomMembers = returnRoomMembersFromRoomObject(rooms);\n  let roomProduct = [];\n  for (let i = 0; i < roomNames.length; i++) {\n    roomProduct.push({\n      name: roomNames[i],\n      id: roomIds[i],\n      members: roomMembers[i],\n    })\n  }\n  Object.assign(roomNamesAndIdsAsObject, roomProduct)\n  console.log(roomNamesAndIdsAsObject)\n  return roomNamesAndIdsAsObject;\n}\n\nfunction createGroup(groupName) {\n  client.createRoom({\n    name: groupName,\n    visibility: 'private',\n  }).then((response) => {\n    console.log(`Room created: ${response.room_id}`);\n  }).catch((error) => {\n    console.error(`Error creating room: ${error}`);\n  });\n}\n\n//TODO - Add a getter to get a room's timeline\n//TODO - Add a getter to get a room's type\n\nexport const useMatrixClient = defineStore('matrix-client', {\n  state: () => {\n    return ({\n      client: client,\n      getGroups: getGroups,\n      createGroup: createGroup,\n    });\n  },\n  getters: {\n    getRooms: (state) => () => {\n      return state.getRooms();\n    },\n    getRoomNamesAndIds: (state) => () => {\n      return state.getGroups();\n    },\n  },\n  setters: {\n    createGroup: (state) => (groupName) => {\n      return state.createGroup(groupName);\n    },\n  }\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}